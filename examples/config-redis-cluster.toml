# LLM Incident Manager Configuration - Redis Cluster Storage Backend
# Redis Cluster provides automatic sharding and high availability

[server]
host = "0.0.0.0"
http_port = 8080
grpc_port = 9000
metrics_port = 9090
tls_enabled = false
request_timeout_secs = 30
max_connections = 10000

[deployment]
mode = "distributed"
region = "us-east-1"
availability_zones = ["us-east-1a", "us-east-1b", "us-east-1c"]

[state]
# Use Redis Cluster for highly available distributed storage
backend = "redis_cluster"

# List of cluster nodes (minimum 3 recommended)
redis_cluster_nodes = [
    "redis://node1.example.com:6379",
    "redis://node2.example.com:6379",
    "redis://node3.example.com:6379",
    "redis://node4.example.com:6379",
    "redis://node5.example.com:6379",
    "redis://node6.example.com:6379",
]

# Connection pool size
pool_size = 100

# Note: Currently the cluster backend connects to the first available node
# Full cluster support with automatic failover will be available in future versions

[processing]
max_concurrent_incidents = 10000
processing_timeout_secs = 300
deduplication_enabled = true
deduplication_window_secs = 900
correlation_enabled = true

[observability]
log_level = "info"
json_logs = true
otlp_enabled = true
otlp_endpoint = "http://jaeger:4317"
service_name = "llm-incident-manager"
prometheus_enabled = true

[notifications]
slack_enabled = true
slack_webhook_env = "SLACK_WEBHOOK_URL"
slack_bot_token_env = "SLACK_BOT_TOKEN"
slack_default_channel = "#incidents"

email_enabled = true
smtp_server = "smtp.example.com"
smtp_port = 587
smtp_use_tls = true
smtp_username_env = "SMTP_USERNAME"
smtp_password_env = "SMTP_PASSWORD"
email_from = "incidents@example.com"
email_from_name = "LLM Incident Manager"

pagerduty_enabled = true
pagerduty_api_token_env = "PAGERDUTY_API_TOKEN"
pagerduty_integration_key_env = "PAGERDUTY_INTEGRATION_KEY"

webhook_enabled = true
max_retries = 3
retry_backoff_secs = 5
queue_size = 10000
worker_threads = 4
